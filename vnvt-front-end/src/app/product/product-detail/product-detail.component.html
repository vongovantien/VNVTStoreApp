<div class="product-detail">
  <section class="product-detail__overview">
    <div class="product-detail__image">
      <img [src]="product.imageUrl" alt="{{ product.name }}">
    </div>
    <div class="product-detail__info">
      <h1 class="product-detail__name">{{ product.name }}</h1>
      <p class="product-detail__price">${{ product.price }}</p>
      <p class="product-detail__description">{{ product.description }}</p>
      <button mat-raised-button color="primary" (click)="addToCart()">Add to Cart</button>
    </div>
  </section>

  <section class="product-detail__comments">
    <h2 class="product-detail__comments__title">Customer Reviews</h2>
    <div class="product-detail__comments__list">
      <div class="product-detail__comment" *ngFor="let comment of comments; let i = index">
        <div class="product-detail__comment__header">
          <img [src]="comment.avatarUrl" alt="{{ comment.user }}" class="product-detail__comment__avatar">
          <div class="product-detail__comment__user">{{ comment.user }}</div>
        </div>
        <div class="product-detail__comment__text">{{ comment.text }}</div>
        <div class="product-detail__comment__rating">Rating: {{ comment.rating }}</div>
        <button mat-button (click)="toggleReplyForm(comment.id)">Reply</button>

        <div *ngIf="comment.showReplyForm" class="product-detail__reply-form">
          <mat-form-field appearance="outline">
            <mat-label>Reply</mat-label>
            <input matInput [(ngModel)]="comment.replyText">
          </mat-form-field>
          <button mat-raised-button color="primary" (click)="submitReply(comment.id)">Submit</button>
        </div>

        <div *ngFor="let reply of comment.replies" class="product-detail__comment product-detail__reply">
          <div class="product-detail__comment__header">
            <img [src]="reply.avatarUrl" alt="{{ reply.user }}" class="product-detail__comment__avatar">
            <div class="product-detail__comment__user">{{ reply.user }}</div>
          </div>
          <div class="product-detail__comment__text">{{ reply.text }}</div>
        </div>
      </div>
    </div>

    <form class="product-detail__comment-form" (ngSubmit)="submitComment()">
      <mat-form-field appearance="fill">
        <mat-label>Your Comment</mat-label>
        <textarea matInput [(ngModel)]="newComment.text" name="commentText" required></textarea>
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Your Rating</mat-label>
        <mat-select [(ngModel)]="newComment.rating" name="commentRating" required>
          <mat-option *ngFor="let rating of [1, 2, 3, 4, 5]" [value]="rating">
            {{ rating }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <button mat-raised-button color="primary" type="submit">Submit Comment</button>
    </form>
  </section>

  <section class="product-detail__trending">
    <h2 class="product-detail__trending__title">Trending Products</h2>
    <div class="product-detail__trending__list">
      <div class="product-detail__trending__item" *ngFor="let product of trendingProducts">
        <img [src]="product.imageUrl" alt="{{ product.name }}" class="product-detail__trending__image">
        <div class="product-detail__trending__name">{{ product.name }}</div>
        <p class="product-detail__trending__price">${{ product.price }}</p>
      </div>
    </div>
  </section>
</div>
